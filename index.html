<script>
  // Hide React root until we know maintenance status
  document.write("<style>#root{display:none}</style>");

  (async () => {
    try {
      // âœ… Replace with your real Supabase project ref
      const resp = await fetch("https://vsruezynaanqprobpvrr.supabase.co/functions/v1/check-maintenance");
      const { allowed } = await resp.json();

      if (!allowed) {
        // Redirect to static maintenance page before React loads
        window.location.replace("/maintenance.html");
      } else {
        const root = document.getElementById("root");
        if (root) root.style.display = "block";
      }
    } catch (err) {
      console.error("Maintenance check failed", err);
      const root = document.getElementById("root");
      if (root) root.style.display = "block"; // fail open
    }
  })();
</script>
